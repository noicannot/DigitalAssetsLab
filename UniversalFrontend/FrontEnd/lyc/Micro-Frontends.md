# 微前端调研

在介绍微前端前，我们先来看看什么是**\*\*微服务，\*\***在后端，我们将原来的单体式应用拆分成了不同的微服务模块，微服务与微服务之间通过服务注册等进行通信和调用，共同对前端提供服务。

**\*\*微服务的好处有以下几点：\*\***

1、复杂度可控: 体积小、复杂度低，每个微服务可由一个小规模开发团队完全掌控，易于保持高可维护性和开发效率。

2、独立部署: 由于微服务具备独立的运行进程，所以每个微服务也可以独立部署。

3、技术选型灵活: 微服务架构下，技术选型是去中心化的。每个团队可以根据自身服务的需求和行业发展的现状，自由选择最适合的技术栈。

4、容错: 当某一组建发生故障时，在单一进程的传统架构下，故障很有可能在进程内扩散，形成应用全局性的不可用。

5、扩展: 单块架构应用也可以实现横向扩展，就是将整个应用完整的复制到不同的节点。

回到今天的主题微前端，其实 ThoughtWorks 早在 2016 年的技术雷达中就提到过微前端这一概念，并将其列入了组织应评估的技术之列。

它是一种类似于微服务的前端架构，能够将不同语言开发的不同系统聚合为一个统一对外的系统，也可以在**\*\*共享组件\*\***的同时并行开发。

如下图所示，假设我们有三个业务子系统，用户如果要使用三个系统中的不同功能，他就需要同时在三个系统中登录然后来回切换进行操作。

![img](https://img-blog.csdnimg.cn/20210714113019858.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80OTQ4MTE4MA==,size_16,color_FFFFFF,t_70)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

而实际上理想的状态是：A、B、C 三个子系统在同一个大平台上，通过菜单提供入口进入，用户可以自由访问任意一个子系统的页面。如下图所示：

![img](https://img-blog.csdnimg.cn/20210714113027825.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80OTQ4MTE4MA==,size_16,color_FFFFFF,t_70)![点击并拖拽以移动](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

**\*\*那应用了微前端会为我们带来什么好处呢：\*\***

1、复杂度可控: 每一个 UI 业务模块由独立的前端团队开发,避免代码巨无霸,保持开发时的高速编译,保持较低的复杂度,便于维护与开发效率。

2、独立部署: 每一个模块可单独部署,颗粒度可小到单个组件的 UI 独立部署,不对其他模块有任何影响。

3、技术选型灵活: 也是最具吸引力的,在同一项目下可以使用如今市面上所有前端技术栈,也包括未来的前端技术栈。

4、容错: 单个模块发生错误,不影响全局。

5、扩展: 每一个服务可以独立横向扩展以满足业务伸缩性，与资源的不必要消耗。

从上面不难看出微前端能够带来的一些好处：独立开发、独立部署、各个系统自治、单一职责、技术栈无关，甚至于能够解决遗留系统的迁移。防止一个普通应用演变为一个不可维护的巨石应用。

需要明确得是微前端不是框架、不是工具/库，而是一套架构体系，它包括若干库、工具、中心化治理平台以及相关配套设施，主要包括已下 3 部分：

微前端的基础设施。这是目前讨论得最多的，一个微应用如何通过一个组件基座加载进来、脚手架工具、怎么单独构建和部署、怎么联调。

微前端配置中心：标准化的配置文件格式，支持灰度、回滚、红蓝、A/B 等发布策略。

微前端的可观察性工具：对于任何分布式特点的架构，线上/线下治理都很重要。

**\*\*目前在业内有这几种方式可以实现微前端：\*\***

路由分发式，即使用 http 服务器的路由重定向应用；

Iframe 式，即通过组合多个独立应用，子应用与子应用之间设计通讯、加载机制；

通用中心路由基座式，即子应用与子应用之间技术栈可以不一样，可以是 Augular、React、Vue 中的任何一种，完全独立，互不依赖，子应用与子应用之间的通信由基座工程进行管理；

特定中心路由基座式，即子应用与子应用之间的技术栈必须一致，子应用可以使用基座的能力进行通信。

**\*\*微前端的框架\*\***

1、 [single-spa](https://link.zhihu.com/?target=https://github.com/single-spa/single-spa)：社区公认的主流方案，可以基于它做二次开发

2、 [qiankun](https://link.zhihu.com/?target=https://github.com/umijs/qiankun)：基于 single-spa 封装，增加 umi 特色，增加沙箱机制（JS、ShadowDOM 等）

3、[icestark](https://link.zhihu.com/?target=https://ice.work/docs/icestark/about)：类似于 single-spa 实现，React 技术栈友好，阿里的另一个轮子
